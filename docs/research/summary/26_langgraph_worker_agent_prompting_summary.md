## LangGraph 워커 에이전트 프롬프트 요약

### 개요
멀티 에이전트 시스템의 품질은 워커 에이전트의 프롬프트에 의해 좌우된다. 역할·제약·도구·워크플로우를 명확히 정의하고, 실패 복구와 평가 체계를 내장해야 한다.

### 핵심 원칙
- 관심사 분리: 워커는 좁고 명확한 역할과 제한된 도구만 가진다.
- 핵심 정체성(시스템 프롬프트): 역할, 목적, 금지 사항(부정적 제약)을 명시한다.
- 도구 설명 품질: 행동 지향적 docstring으로 올바른 도구 선택/파라미터화를 유도한다.
- ReAct 루프: Thought → Action → Observation 사이클을 표준 워크플로우로 채택한다.

### 부정적 제약 조건
역할 잠식을 방지하기 위해 “하지 말아야 할 것”을 명시한다. 예: research_agent는 “차트를 생성하지 않는다”, code_agent는 “리서치를 하지 않는다”.

### 프롬프트 템플릿(청사진)
1) 역할/페르소나 2) 핵심 지침/제약 3) 도구 목록·설명 4) ReAct 지침 5) 오류 처리·자가 수정 6) 출력 형식(JSON 등)

### 자가 수정 루프
- 노드: generate → check_code(오류 플래그) → reflect(분석) → generate
- 프롬프트: 오류 원인 분석 → 해결 계획 → 수정안 생성까지 강제하는 구조

### 강건성 설계
- 명확한 핵심 지시, 충분한 문맥, 구조화된 형식(XML/마크다운), 불확실성·범위 이탈 시 Fallback 규칙
- 보안: 프롬프트 주입·유출 방지 지침을 포함해 ‘정책 문서화’ 수준으로 강화

### 평가 프레임워크(LangSmith)
- 메트릭: Task Completion, Correctness, Tool Correctness, Answer Relevancy, Groundedness, Latency, Cost
- 워크플로우: 데이터셋 생성 → 타겟 함수 래핑 → 평가자 정의 → 실험 실행 → 결과 분석
- 궤적 평가: 도구 호출 순서·생각·관찰의 전 과정 비교로 근본 원인 진단

### 반복 개발 주기
설계 → v1 프롬프트 → 소규모 평가 → 실패 모드 분석 → 프롬프트 개선(부정 제약/도구 설명/자가 수정) → 재평가 → 반복

### 체크리스트
- 역할·제약·도구 설명이 명확한가
- ReAct 형식을 준수하는가
- 오류 처리와 자가 수정 루프가 있는가
- 평가 지표와 데이터셋이 준비되었는가
- 프롬프트가 버전 관리되며 변경이 평가로 검증되는가


